# language setting
language: node_js

build_image: drydock/u12nod:prod
# Version number
node_js:
 - 4.2.3
# Path to output test report
env:
 - XUNIT_FILE=shippable/testresults/result.xml

install:
 - source ~/.nvm/nvm.sh && nvm install 4.2.3
 - node --version
 - docker stop test
 - docker rm test
 - docker run -d -p 3002:3002 --name test tetsuoharano/node-web-app
 - docker logs test
 - docker port test
 - ifconfig
 - curl 127.0.0.1:3002
 - curl localhost:3002

# Create directories for test and coverage reports
before_script:
 - mkdir -p shippable/testresults
 - mkdir -p shippable/codecoverage
 - npm install -g grunt-cli grunt

script:
 - npm run testall
 - docker logs apiServer
 - docker port apiServer
 - docker-machine ls
 - curl 127.0.0.1:3002
# language setting
language: node_js

build_image: drydock/u12nod:prod
# Version number
node_js:
 - 4.2.3
# Path to output test report
env:
 - XUNIT_FILE=shippable/testresults/result.xml

install:
 - source ~/.nvm/nvm.sh && nvm install 4.2.3
 - node --version
 - npm config set registry http://registry.npmjs.org/
 - docker pull tetsuoharano/snapaskoceanapi-newhome:1.0
 - docker stop apiServer
 - docker rm apiServer
 - docker run -d -p 3001:3001 --name apiServer tetsuoharano/snapaskoceanapi-newhome:1.0
 - curl 127.0.0.1:3001
 - npm install

# Create directories for test and coverage reports
before_script:
 - mkdir -p shippable/testresults
 - mkdir -p shippable/codecoverage
 - npm install -g grunt-cli grunt

script:
 - npm run testall
 - docker logs apiServer
 - docker port apiServer
 - docker-machine ls
